
(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?a(exports):typeof define==="function"&&define.amd?define(["exports"],a):(a((b.SR360={})))}(this,(function(R){var y=(function(){function aX(aY){this.data=aY}return aX}());function Z(aX){var aZ=y.prototype;for(var aY in aX){if(aX.hasOwnProperty(aY)){if(aZ[aY]){throw new Error("API method is already defined: "+aY)}else{aZ[aY]=aX[aY]}}}return aZ}var aA=window.jQuery||window.$;function V(aX){var aZ=aX.touches;var aY=aX;if(aX.touches===undefined&&aX.originalEvent!==undefined){aZ=aX.originalEvent.touches}if(aZ!==undefined&&aZ.length>0){aY=aZ[0]}return{x:aY.clientX||0,y:aY.clientY||0}}var aT;var aq;function aR(){if(aq){return aq}if(!aT){aT=document.createElement("canvas")}if(!aT||!aT.getContext){return null}aq=aT.getContext("2d");return aq}function ag(aY,aZ,aX){if(!aR()){return false}if(aZ*aX<=1024*1024){return false}aT.width=aT.height=1;aq.fillStyle="#FF00FF";aq.fillRect(0,0,1,1);aq.drawImage(aY,-aZ+1,0);try{var a1=aq.getImageData(0,0,1,1).data;return(a1[0]===255)&&(a1[1]===0)&&(a1[2]===255)}catch(a0){return false}}function am(aZ){var aY=Math.floor(aZ.width||aZ.frameWidth||aZ.target.innerWidth());var aX=Math.floor(aZ.height||aZ.frameHeight||aZ.target.innerHeight());return{aspect:aY/aX,height:aX,width:aY}}function l(aZ){var aX=am(aZ);if(typeof window.getComputedStyle!=="function"){return aX}var aY=window.getComputedStyle(aZ.target[0]);if(!aY.width){return aX}aX.width=Math.floor(Number(aY.width.replace("px","")));aX.height=Math.floor(aX.width/aX.aspect);return aX}function ak(aZ){var aY=Math.floor(aZ.frameWidth||aZ.width||aZ.target.innerWidth());var aX=Math.floor(aZ.frameHeight||aZ.height||aZ.target.innerHeight());return{aspect:aY/aX,height:aX,width:aY}}function B(a0,a6,a5){var aZ=a0==="fit";var a1=a0==="fill";var aY=a0==="stretch";var a2={width:"100%",height:"100%",top:0,left:0,bottom:0,right:0,position:"absolute",overflow:"hidden"};if(!a0||aY){return a2}var a3=a6.aspect>=a5.aspect;var aX=a6.width;var a4=a6.height;if(aZ&&a3||a1&&!a3){aX=a5.width;a4=a5.width/a6.aspect}if(a1&&a3||aZ&&!a3){a4=a5.height;aX=a5.height*a6.aspect}aX=Math.floor(aX);a4=Math.floor(a4);a2.width=aX;a2.height=a4;a2.top=Math.floor((a5.height-a4)/2);a2.left=Math.floor((a5.width-aX)/2);a2.right=a2.left;a2.bottom=a2.top;return a2}var S;function av(aX){if(aX.naturalWidth){return{height:aX.naturalHeight,width:aX.naturalWidth}}S=S||new Image();S.src=aX.src;return{height:S.height,width:S.width}}function E(aX,aY){if(aX.length===1){return[n(aX[0],aY)]}else{if(aY.framesX&&aY.framesY){return e(aX,aY)}else{return aP(aX,aY)}}}function n(aY,a7){var a8={id:0,sprites:[]};aW(aY,a7,a8);var a3=a7.frames;var a2=Number(a7.framesX)||a3;var a1=Math.ceil(a3/a2);var a5=Math.floor(a8.width/a2);var aZ=Math.floor(a8.height/a1);var aX=a8.isSubsampled?2:1;for(var a0=0;a0<a3;a0++){var a6=(a0%a2)*a5;var a4=Math.floor(a0/a2)*aZ;a8.sprites.push({id:a0,x:a6,y:a4,width:a5,height:aZ,sampledX:a6/aX,sampledY:a4/aX,sampledWidth:a5/aX,sampledHeight:aZ/aX})}return a8}function aP(aY,aZ){var aX=[];for(var a1=0;a1<aY.length;a1++){var a0=n(aY[a1],{frames:1,framesX:1,detectSubsampling:aZ.detectSubsampling});a0.id=a1;aX.push(a0)}return aX}function e(aY,aZ){var aX=[];for(var a1=0;a1<aY.length;a1++){var a0=n(aY[a1],{frames:undefined,framesX:aZ.framesX,framesY:aZ.framesY,detectSubsampling:aZ.detectSubsampling});a0.id=a1;aX.push(a0)}return aX}function aW(a0,aY,aX){var aZ=av(a0);aX.isSubsampled=aY.detectSubsampling&&ag(a0,aZ.width,aZ.height);aX.width=aZ.width;aX.height=aZ.height;aX.sampledWidth=aZ.width/(aX.isSubsampled?2:1);aX.sampledHeight=aZ.height/(aX.isSubsampled?2:1);return aX}function v(a0,a4,a3,aX){var a2=aX*a4+a3;var a1=0;var aZ=null;var aY=null;while(true){aY=a0[a1];if(!aY){break}if(a2>=aY.sprites.length){a2-=aY.sprites.length;a1++;continue}aZ=aY.sprites[a2];break}return{sprite:aZ,sheet:aY}}function o(aZ,aX){for(var aY=0;aY<aX.length;aY++){if(aX[aY]===aZ){return aY}}}function aC(){}function aJ(aY){var aX;var bb=aY.source;aX=typeof bb==="string"?[bb]:bb;var a9=[];var a0=(aY.preloadCount||aX.length);var ba=aY.initiated||aC;var bc=aY.progress||aC;var a1=aY.complete||aC;var a6=0;var a4=false;var a8=false;var a5=function(){a6+=1;bc({index:o(this,a9),loaded:a6,total:aX.length,percent:Math.round((a6/aX.length)*100)});a8=a8||(this===a9[0]);if(a8&&!a4&&(a6>=a0)){a4=true;a1(a9)}};for(var a2=0,a7=aX;a2<a7.length;a2++){var aZ=a7[a2];var a3=new Image();a9.push(a3);a3.onload=a3.onabort=a3.onerror=a5;a3.src=aZ}ba(a9)}function aK(aY,aZ,a0){var aX=String(aY);while(aX.length<aZ){aX=String(a0)+aX}return aX}function i(a7,aY){var a0=aY.digits||2;var a5=aY.lanePlacer||"{lane}";var a4=aY.framePlacer||"{frame}";var a2=0;var a6=0;if(aY.frame){a2=aY.frame[0];a6=aY.frame[1]}var aX=0;var a1=0;if(aY.lane){aX=aY.lane[0];a1=aY.lane[1]}var a8=[];for(var a3=aX;a3<=a1;a3+=1){for(var aZ=a2;aZ<=a6;aZ+=1){a8.push(a7.replace(a5,aK(a3,a0,"0")).replace(a4,aK(aZ,a0,"0")))}}return a8}var ax="sr360";var aw=["mousedown","mousemove","mouseup","mouseenter","mouseover","mouseleave","mousewheel","wheel","click","dblclick","touchstart","touchmove","touchend","touchcancel","selectstart","gesturestart","gesturechange","gestureend"];var ae=["onInit","onProgress","onLoad","onFrameChanged","onFrame","onDraw","onComplete","onDestroy"];var T=["dragstart"];var W={source:undefined,width:undefined,height:undefined,frames:undefined,framesX:undefined,lanes:1,sizeMode:undefined,renderer:"canvas",lane:0,frame:0,frameTime:40,animate:true,retainAnimate:false,reverse:false,loop:true,stopFrame:0,wrap:true,wrapLane:false,sense:1,senseLane:undefined,orientation:"horizontal",detectSubsampling:true,preloadCount:undefined,touchScrollTimer:[200,1500],responsive:undefined,plugins:undefined};function Y(){}function m(aX){return console&&console[aX]?function(){var aY=[];for(var aZ=0;aZ<arguments.length;aZ++){aY[aZ]=arguments[aZ]}return console.log.apply(console,aY)}:Y}var f=m("log");var aU=m("warn");var ay=m("error");function J(aX){return Array.isArray(aX)?aX:[aX]}function aI(aZ,aY,aX){return(aZ>aX?aX:(aZ<aY?aY:aZ))}function w(a0,aZ,aX,aY){while(a0>aX){a0-=aY}while(a0<aZ){a0+=aY}return a0}function z(aX){aX.preventDefault();return false}function aL(aZ,aY,aX){if(aX){aZ.bind(aY+"."+ax,function(a0){aX.apply(aZ,[a0,aZ.sr360("data")])})}}function N(aX){aX.unbind("."+ax)}function aH(aX){return typeof aX==="function"}function p(aY){var aX=window.devicePixelRatio||1;var aZ=aY.webkitBackingStorePixelRatio||aY.mozBackingStorePixelRatio||aY.msBackingStorePixelRatio||aY.oBackingStorePixelRatio||aY.backingStorePixelRatio||1;return aX/aZ}var M=Object.freeze({$:aA,getCursorPosition:V,detectSubsampling:ag,getOuterSize:am,getComputedSize:l,getInnerSize:ak,getInnerLayout:B,measure:E,findSpecs:v,naturalSize:av,preload:aJ,sourceArray:i,noop:Y,log:f,warn:aU,error:ay,toArray:J,clamp:aI,wrap:w,prevent:z,bind:aL,unbind:N,isFunction:aH,pixelRatio:p});function P(aZ){aZ.target.attr("unselectable","on").css({width:"",height:"","-ms-user-select":"none","-moz-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","user-select":"none"});var aX=aZ.responsive?l(aZ):am(aZ);var aY=B(aZ.sizeMode,ak(aZ),aX);aZ.target.css({width:aX.width,height:aX.height,position:"relative",overflow:"hidden"});aZ.stage.css(aY).hide();if(!aZ.canvas){return}aZ.canvas.css(aY).hide();aZ.canvasRatio=aZ.canvasRatio||p(aZ.context);if(typeof aY.width==="number"&&typeof aY.height==="number"){aZ.canvas[0].width=(aY.width*aZ.canvasRatio)||aX.width;aZ.canvas[0].height=(aY.height*aZ.canvasRatio)||aX.height}else{aZ.canvas[0].width=(aX.width*aZ.canvasRatio);aZ.canvas[0].height=(aX.height*aZ.canvasRatio)}aZ.context.scale(aZ.canvasRatio,aZ.canvasRatio)}function r(aY,aX){aY.state=aY.state||{};aY.state[aX]=aY.state[aX]||{};return aY.state[aX]}function A(aZ,aX){var aY=r(aZ,"plugin");aY[aX]=aY[aX]||{};return aY[aX]}function G(aY,aX){return !!r(aY,"flags")[aX]}function aV(aZ,aX,aY){r(aZ,"flags")[aX]=!!aY}function C(aX){return r(aX,"playback")}function L(aY,aX){aY.lane=aY.wrapLane?w(aX,0,aY.lanes-1,aY.lanes):aI(aX,0,aY.lanes-1)}function g(aX){aX.frame+=(aX.reverse?-1:1);aX.frame=w(aX.frame,0,aX.frames-1,aX.frames);if(!aX.loop&&(aX.frame===aX.stopFrame)){D(aX)}}function aN(aX,aY){aX.frame=Number(aY);aX.frame=aX.wrap?w(aX.frame,0,aX.frames-1,aX.frames):aI(aX.frame,0,aX.frames-1)}function ai(aY){var aX=C(aY);if(aX.handler){j(aY);g(aY);O(aY)}}function j(aY){var aX=C(aY);aX.lastFrame=aY.frame;aX.lastLane=aY.lane}function O(aY){var aX=C(aY);if(aX.lastFrame!==aY.frame||aX.lastLane!==aY.lane){aY.target.trigger("onFrameChanged."+ax,aY)}aY.target.trigger("onFrame."+ax,aY);aY.target.trigger("onDraw."+ax,aY)}function q(aY,aZ,aX){j(aY);if(aZ!=null){aN(aY,aZ)}if(aX!=null){L(aY,aX)}O(aY)}function D(aY){aY.animate=false;var aX=C(aY);if(aX.handler!=null){window.clearInterval(aX.handler);aX.handler=null}}function X(aY){var aX=C(aY);if(aX.handler&&(!aY.animate||aX.frameTime!==aY.frameTime)){D(aY)}if(aY.animate&&!aX.handler){aX.frameTime=aY.frameTime;aX.handler=window.setInterval(function(){return ai(aY)},aX.frameTime)}}function k(aX){aX.animate=true;X(aX)}var aB={};function b(aX,aY){if(aB[aX]){ay('Plugin name "'+aX+'" is already taken');return}aY=aY||{};aB[aX]=aY;return aY}function ao(aX,aY){aU('"registerModule" is deprecated, use "registerPlugin" instead');b(aX,aY)}function c(aX){return aB[aX]}function x(a0){aj(a0);for(var aY=0;aY<a0.plugins.length;aY+=1){var aX=a0.plugins[aY];if(typeof aX!=="string"){continue}var aZ=c(aX);if(!aZ){ay("No plugin found with name "+aX);continue}a0.plugins[aY]=aZ}}function aj(aX){if(aX.mods){aU('"mods" option is deprecated, use "plugins" instead');aX.plugins=aX.mods;delete aX.mods}if(aX.behavior){aU('"behavior" option is deprecated, use "plugins" instead');aX.plugins.push(aX.behavior);delete aX.behavior}if(aX.module){aU('"module" option is deprecated, use "plugins" instead');aX.plugins.push(aX.module);delete aX.module}}var az=aA;var aG=0;var ab={};function U(aX){aG+=1;aX.id=String(aG);ab[aX.id]=aX}function I(aX){delete ab[aX.id]}function ac(aX){for(var aY in ab){if(ab.hasOwnProperty(aY)){aX(ab[aY])}}}var aQ=function(){aQ=function(){};function a3(a4,a5){ac(function(a9){for(var a8=0,a7=a9.plugins;a8<a7.length;a8++){var a6=a7[a8];if(typeof a6[a4]==="function"){a6[a4].apply(a9.target,[a5,a9])}}})}function a1(){ac(function(a4){if(a4.responsive){Q(a4)}})}var aX=function(a4){az(window.document).bind(a4+"."+ax,function(a5){a3("document"+a4,a5)})};for(var a2=0,aZ=aw;a2<aZ.length;a2++){var aY=aZ[a2];aX(aY)}var a0=null;az(window).on("resize",function(){window.clearTimeout(a0);a0=window.setTimeout(a1,100)})};function s(aZ){var a5=aZ.target;N(a5);for(var aY=0,aX=T;aY<aX.length;aY++){var a7=aX[aY];aL(a5,a7,z)}for(var a9=0,a8=aZ.plugins;a9<a8.length;a9++){var a1=a8[a9];for(var a6=0,ba=aw;a6<ba.length;a6++){var a7=ba[a6];aL(a5,a7,a1[a7])}for(var a4=0,a3=ae;a4<a3.length;a4++){var a7=a3[a4];aL(a5,a7,a1[a7])}}aL(a5,"onLoad",function(bb,bc){X(bc)});for(var a2=0,a0=ae;a2<a0.length;a2++){var a7=a0[a2];aL(a5,a7,aZ[a7])}}function aM(aY){if(!aY.images){aY.metrics=[]}aY.metrics=E(aY.images,aY);var aX=v(aY.metrics,aY.frames,0,0);if(aX.sprite){aY.frameWidth=aX.sprite.width;aY.frameHeight=aX.sprite.height}}function Q(aX){x(aX);s(aX);P(aX);aX.source=J(aX.source);aX.loading=true;aX.target.addClass("loading").trigger("onInit."+ax,aX);aJ({source:aX.source,preloadCount:aX.preloadCount,progress:function(aY){aX.progress=aY;aX.target.trigger("onProgress."+ax,aX)},complete:function(aY){aX.images=aY;aX.loading=false;aX.frames=aX.frames||aY.length;aM(aX);P(aX);aX.stage.show();aX.target.removeClass("loading").trigger("onLoad."+ax,aX).trigger("onFrame."+ax,aX).trigger("onDraw."+ax,aX).trigger("onComplete."+ax,aX)}})}function t(aY){var a1=this;var a0=aY.target;var aZ=az.extend(true,{},W,aY);aZ.source=aZ.source||[];aZ.plugins=aZ.plugins||["360","drag"];a0.find("img").each(function(){if(!Array.isArray(aZ.source)){aZ.source=[]}aZ.source.push(az(a1).attr("src"))});a0.empty().addClass("sr360-instance").append("<div class='sr360-stage'></div>");if(aZ.renderer==="canvas"){var aX=document.createElement("canvas");if(!!(aX.getContext&&aX.getContext("2d"))){aZ.canvas=az(aX).addClass("sr360-canvas");aZ.context=aX.getContext("2d");a0.append(aZ.canvas);a0.addClass("with-canvas")}else{aZ.renderer="image"}}aZ.target=a0;aZ.stage=a0.find(".sr360-stage");a0.data(ax,aZ);U(aZ);return aZ}function ar(aX){aQ();var aY=aX.target.data(ax);if(!aY){aY=t(aX)}else{az.extend(aY,aX)}Q(aY);return aY}function h(aX){I(aX);D(aX);aX.target.trigger("onDestroy",aX).html(null).attr("style",null).attr("unselectable",null).removeClass(["sr360-instance","with-canvas"]);N(aX.target);aX.target.removeData(ax)}function u(aX){return r(aX,"input")}function an(aZ,aY){var a0=V(aZ);var aX=u(aY);aX.oldX=aX.currentX;aX.oldY=aX.currentY;aX.currentX=a0.x;aX.currentY=a0.y;if(aX.oldX===undefined||aX.oldY===undefined){aX.oldX=aX.currentX;aX.oldY=aX.currentY}if(aX.startX===undefined||aX.startY===undefined){aX.startX=aX.currentX;aX.startY=aX.currentY;aX.clickframe=aY.frame;aX.clicklane=aY.lane}aX.dX=aX.currentX-aX.startX;aX.dY=aX.currentY-aX.startY;aX.ddX=aX.currentX-aX.oldX;aX.ddY=aX.currentY-aX.oldY;aX.ndX=aX.dX/aY.target.innerWidth();aX.ndY=aX.dY/aY.target.innerHeight();aX.nddX=aX.ddX/aY.target.innerWidth();aX.nddY=aX.ddY/aY.target.innerHeight()}function F(aY){var aX=u(aY);aX.startX=aX.startY=undefined;aX.currentX=aX.currentY=undefined;aX.oldX=aX.oldY=undefined;aX.dX=aX.dY=0;aX.ddX=aX.ddY=0;aX.ndX=aX.ndY=0;aX.nddX=aX.nddY=0}function aD(aZ,a1){var aX=aA(this);if(aZ==="data"){return aX.data(ax)}if(aZ==="api"){var a0=aX.data(ax);a0.api=a0.api||new y(a0);return a0.api}if(aZ==="destroy"){return aX.each(function(){var a2=aX.data(ax);if(a2){h(a2)}})}if(arguments.length===2&&typeof aZ==="string"){aZ=(aY={},aY[aZ]=a1,aY)}if(typeof aZ==="object"){return ar(aA.extend(true,{target:aX},aZ)).target}throw new Error("Invalid call to sr360");var aY}aA.fn[ax]=aD;Z({isPlaying:function(){return C(this.data).handler!=null},isLooping:function(){return this.data.loop},toggleAnimation:function(){if(this.isPlaying()){this.stopAnimation()}else{this.startAnimation()}},stopAnimation:function(){this.data.animate=false;D(this.data)},startAnimation:function(){this.data.animate=true;X(this.data)},loop:function(aX){this.data.loop=aX;X(this.data);return this},currentFrame:function(){return this.data.frame},updateFrame:function(aX){q(this.data,aX);return this},skipFrames:function(aX){var aY=this.data;q(aY,aY.frame+(aY.reverse?-aX:+aX));return this},nextFrame:function(){return this.skipFrames(1)},prevFrame:function(){return this.skipFrames(-1)},playTo:function(a1,aZ){var a0=this.data;aZ=aZ||{};if(!aZ.force&&a0.frame===a1){return}if(aZ.nearest){var aY=a1-a0.frame;var aX=a1>a0.frame?aY-a0.frames:aY+a0.frames;var a2=Math.abs(aY)<Math.abs(aX)?aY:aX;a0.reverse=a2<0}a0.animate=true;a0.loop=false;a0.stopFrame=a1;X(a0);return this}});function a(a1,a0){for(var aZ=0,aY=a0;aZ<aY.length;aZ++){var aX=aY[aZ];if(a1[aX]||aX in a1){return aX}}return a0[0]}var aF={requestFullscreen:a(document.documentElement,["requestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"]),exitFullscreen:a(document,["exitFullscreen","webkitExitFullscreen","webkitCancelFullScreen","mozCancelFullScreen","msExitFullscreen"]),fullscreenElement:a(document,["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"]),fullscreenEnabled:a(document,["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"]),fullscreenchange:a(document,["onfullscreenchange","onwebkitfullscreenchange","onmozfullscreenchange","onMSFullscreenChange"]).replace(/^on/,""),fullscreenerror:a(document,["onfullscreenerror","onwebkitfullscreenerror","onmozfullscreenerror","onMSFullscreenError"]).replace(/^on/,"")};var ap=aF.fullscreenchange+"."+ax+"-fullscreen";function K(){aA(document).unbind(ap)}function aO(aX){K();aA(document).bind(ap,aX)}var aa="orientationchange."+ax+"-fullscreen";function d(){aA(window).unbind(aa)}function aS(aX){d();aA(window).bind(aa,aX)}function H(aX){aX=aX||document.documentElement;aX[aF.requestFullscreen]()}function au(){return document[aF.exitFullscreen]()}function aE(){return document[aF.fullscreenEnabled]}function at(){return document[aF.fullscreenElement]}function ad(){return !!at()}function al(aY,aX){if(ad()){this.apiRequestFullscreen(aX)}else{this.exitFullscreen()}}function af(a1,aX){aX=aX||{};var a5=a1.width;var aZ=a1.height;var a2=a1.source;var a4=a1.sizeMode;var a0=a1.responsive;var a3=function(){a1.width=window.screen.width;a1.height=window.screen.height;a1.source=(aX.source||a2);a1.sizeMode=aX.sizeMode||"fit";a1.responsive=false;Q(a1)};var aY=function(){a1.width=a5;a1.height=aZ;a1.source=a2;a1.sizeMode=a4;a1.responsive=a0;Q(a1)};aO(function(){if(ad()){a3();aS(a3)}else{K();d();aY()}});H(a1.target[0])}Z({fullscreenEnabled:aE,fullscreenElement:at,exitFullscreen:au,toggleFullscreen:function(aX){al(this.data,aX)},requestFullscreen:function(aX){af(this.data,aX)}});(function(){var aY="click";function aX(a3,a1){if(a1.loading||!a1.stage.is(":visible")){return}an(a3,a1);var aZ=u(a1);var a0,a5;var a2=a1.target,a4=a2.offset();if(a1.orientation==="horizontal"){a0=a2.innerWidth()/2;a5=aZ.currentX-a4.left}else{a0=a2.innerHeight()/2;a5=aZ.currentY-a4.top}q(a1,a1.frame+(a5>a0?1:-1))}b(aY,{name:aY,mouseup:aX,touchend:aX})})();(function(){var a3="drag";function aZ(a5){return A(a5,a3)}function a4(a5){if(typeof a5.orientation==="number"){return a5.orientation*Math.PI/180}if(a5.orientation==="horizontal"){return 0}return Math.PI/2}function a2(a8,a7){var a6=aZ(a7);var a9=[200,1500];var a5=a7.touchScrollTimer||a9;a6.minTime=a5[0]||a9[0];a6.maxTime=a5[1]||a9[1]}function aY(a8,a7){var a6=aZ(a7);if(a7.loading||G(a7,"dragging")||a7.zoomPinFrame&&!a7.stage.is(":visible")){return}var a5=new Date().getTime();if(a6.endAt&&(a5-a6.endAt>a6.maxTime)){a6.startAt=null;a6.endAt=null}if(a6.startAt&&(a5-a6.startAt>a6.minTime)){a8.preventDefault()}a6.startAt=a5;a6.wasPlaying=!!C(a7).handler;a6.frame=a7.frame||0;a6.lane=a7.lane||0;aV(a7,"dragging",true);an(a8,a7)}function aX(a6,a5){if(G(a5,"dragging")){aZ(a5).endAt=new Date().getTime();aV(a5,"dragging",false);F(a5);if(a5.retainAnimate&&aZ(a5).wasPlaying){k(a5)}}}function a1(bb,a9){var a5=aZ(a9);var be=u(a9);if(!G(a9,"dragging")){return}an(bb,a9);var bc=a4(a9);var a6=Math.sin(bc);var ba=Math.cos(bc);var bf=((be.nddX*ba-be.nddY*a6)*a9.sense)||0;var bd=((be.nddX*a6+be.nddY*ba)*(a9.senseLane||a9.sense))||0;a5.frame+=a9.frames*bf;a5.lane+=a9.lanes*bd;var a8=a9.frame;var a7=a9.lane;q(a9,Math.floor(a5.frame),Math.floor(a5.lane));D(a9)}function a0(a6,a5){aY(a6,a5);a1(a6,a5)}b("drag",{name:"drag",onInit:a2,mousedown:aY,mousemove:a1,mouseup:aX,documentmousemove:a1,documentmouseup:aX,touchstart:aY,touchmove:a1,touchend:aX,touchcancel:aX});b("move",{name:"move",onInit:a2,mousemove:a0,mouseleave:aX,touchstart:aY,touchmove:a1,touchend:aX,touchcancel:aX})})();(function(){var a0="hold";function aZ(a5){return A(a5,a0)}function a4(a6){var a5=aZ(a6);a5.frameTime=a6.frameTime;a5.animate=a6.animate;a5.reverse=a6.reverse}function a1(a6){var a5=aZ(a6);a6.frameTime=a5.frameTime;a6.animate=a5.animate;a6.reverse=a5.reverse}function a3(a6,a5){if(G(a5,"loading")||G(a5,"dragging")||!a5.stage.is(":visible")){return}a4(a5);an(a6,a5);aV(a5,"dragging",true);a5.animate=true;X(a5)}function aY(a6,a5){aV(a5,"dragging",false);F(a5);D(a5);a1(a5);X(a5)}function a2(a9,a7){if(!G(a7,"dragging")){return}an(a9,a7);var a5=u(a7);var a6,bb;var a8=a7.target,ba=a8.offset();if(a7.orientation==="horizontal"){a6=a8.innerWidth()/2;bb=(a5.currentX-ba.left-a6)/a6}else{a6=(a7.height/2);bb=(a5.currentY-ba.top-a6)/a6}a7.reverse=bb<0;bb=bb<0?-bb:bb;a7.frameTime=80*(1-bb)+20;if(((a7.orientation==="horizontal")&&(a5.dX<a5.dY))||((a7.orientation==="vertical")&&(a5.dX<a5.dY))){a9.preventDefault()}}function aX(a6,a5){a5.animate=true;X(a5)}b(a0,{name:a0,mousedown:a3,mousemove:a2,mouseup:aY,mouseleave:aY,touchstart:a3,touchmove:a2,touchend:aY,touchcancel:aY,onFrame:aX})})();(function(){var a0="swipe";function aZ(a4){return A(a4,a0)}function aY(a5,a4,a6){return a5[a4]||a6}function a1(a6,a5){var a4=aZ(a5);a4.fling=aY(a5,"swipeFling",10);a4.snap=aY(a5,"swipeSnap",0.5)}function a3(a5,a4){if(!a4.loading&&!G(a4,"dragging")){an(a5,a4);aV(a4,"dragging",true)}}function a2(a6,a5){if(!G(a5,"dragging")){return}an(a6,a5);var a7=a5.frame;var a4=a5.lane;q(a5,a7,a4)}function aX(bc,ba){if(!G(ba,"dragging")){return}aV(ba,"dragging",false);var a5=aZ(ba);var bd=u(ba);var a7=ba.frame;var a8=ba.lane;var a9=a5.snap;var a4=a5.fling;var bb,a6;if(ba.orientation==="horizontal"){bb=bd.ndX;a6=bd.ddX}else{bb=bd.ndY;a6=bd.ddY}if(bb>=a9||a6>=a4){a7=ba.frame-1}else{if(bb<=-a9||a6<=-a4){a7=ba.frame+1}}F(ba);q(ba,a7,a8);D(ba)}b(a0,{name:a0,onLoad:a1,mousedown:a3,mousemove:a2,mouseup:aX,mouseleave:aX,touchstart:a3,touchmove:a2,touchend:aX,touchcancel:aX})})();(function(){var aY="wheel";function aX(a3,a2){if(!a2.loading&&a2.stage.is(":visible")){a3.preventDefault();var aZ=a3.originalEvent;var a1=aZ.deltaX===0?0:aZ.deltaX>0?1:-1;var a0=aZ.deltaY===0?0:aZ.deltaY>0?1:-1;q(a2,a2.frame+a0,a2.lane+a1)}}b(aY,{name:aY,wheel:aX})})();(function(){var aZ="\n<div class='sr360-progress'>\n  <div class='sr360-progress-label'></div>\n  <div class='sr360-progress-bar'></div>\n</div>\n";function aX(a4){return A(a4,a3)}var a3="progress";function a1(a6,a5){var a4=aX(a5);if(!a4.stage){a4.stage=aA(aZ);a4.stage.appendTo(a5.target)}a4.stage.find(".sr360-progress-label").text("0%").css({"text-align":"center"});a4.stage.find(".sr360-progress-bar").css({width:"0%"});a4.stage.hide().fadeIn()}function a2(a6,a5){var a4=aX(a5);a4.stage.find(".sr360-progress-label").text(a5.progress.percent+"%").css({"text-align":"center"});a4.stage.find(".sr360-progress-bar").css({width:a5.progress.percent+"%"})}function aY(a5,a4){aA(aX(a4).stage).fadeOut()}function a0(a5,a4){aA(aX(a4).stage).remove()}b(a3,{name:a3,onInit:a1,onProgress:a2,onLoad:aY,onDestroy:a0})})();(function(){var aY="360";function aX(a1,a0){a0.stage.find(".sr360-frames").detach();if(a0.renderer==="image"){$(a0.images).addClass("sr360-frames").appendTo(a0.stage)}}function aZ(a7,a5){var a3=v(a5.metrics,a5.frames,a5.frame,a5.lane);var a8=a3.sheet;var bd=a3.sprite;if(!a8||!bd){return}var a0=a5.source[a8.id];var a4=a5.images[a8.id];if(a5.renderer==="canvas"){a5.canvas.show();var bb=a5.canvas[0].width/a5.canvasRatio;var a6=a5.canvas[0].height/a5.canvasRatio;a5.context.clearRect(0,0,bb,a6);a5.context.drawImage(a4,bd.sampledX,bd.sampledY,bd.sampledWidth,bd.sampledHeight,0,0,bb,a6);return}var bc=a5.stage.innerWidth()/bd.sampledWidth;var ba=a5.stage.innerHeight()/bd.sampledHeight;var a9=Math.floor(-bd.sampledY*ba);var a2=Math.floor(-bd.sampledX*bc);var a1=Math.floor(a8.sampledWidth*bc);var be=Math.floor(a8.sampledHeight*ba);if(a5.renderer==="background"){a5.stage.css({"background-image":"url('"+a0+"')","background-position":a2+"px "+a9+"px","background-repeat":"no-repeat","-webkit-background-size":a1+"px "+be+"px","-moz-background-size":a1+"px "+be+"px","-o-background-size":a1+"px "+be+"px","background-size":a1+"px "+be+"px"});return}$(a5.images).hide();$(a4).show().css({position:"absolute",top:a9,left:a2,"max-width":"initial",width:a1,height:be})}b(aY,{name:aY,onLoad:aX,onDraw:aZ})})();(function(){var ba="blur";function a0(bb){return A(bb,ba)}function aY(bc,bb,bd){return bc[bb]||bd}function a7(bg,bf){var be=a0(bf);be.canvas=be.canvas||aA("<canvas class='blur-layer'></canvas>");be.context=be.context||be.canvas[0].getContext("2d");be.steps=be.steps||[];be.fadeTime=Math.max(aY(bf,"blurFadeTime",200),1);be.frameTime=Math.max(aY(bf,"blurFrameTime",bf.frameTime),16);be.trackTime=null;be.cssBlur=!!aY(bf,"blurCss",false);var bb=ak(bf);var bd=bf.responsive?l(bf):am(bf);var bc=B(bf.sizeMode,bb,bd);be.canvas[0].width=bf.width*bf.canvasRatio;be.canvas[0].height=bf.height*bf.canvasRatio;be.canvas.css(bc).show();be.context.scale(bf.canvasRatio,bf.canvasRatio);bf.target.append(be.canvas)}function a8(bd,bc){var bb=a0(bc);aX(bc);if(bb.timeout==null){a3(bc)}}function aX(bd){var bc=a0(bd);var bb=C(bd);var be=Math.abs(bd.frame-bb.lastFrame);be=be>=bd.frames/2?bd.frames-be:be;bc.steps.unshift({frame:bd.frame,lane:bd.lane,live:1,step:bc.frameTime/bc.fadeTime,d:be,alpha:0})}var aZ=[];function a4(bf){aZ.length=0;for(var bb=0;bb<bf.length;bb+=1){if(bf[bb].alpha<=0){aZ.push(bb)}}for(var be=0,bc=aZ;be<bc.length;be++){var bd=bc[be];bf.splice(bd,1)}}function a3(bc){var bb=a0(bc);bb.timeout=window.setTimeout(function(){a2(bc)},bb.frameTime)}function a1(bc){var bb=a0(bc);window.clearTimeout(bb.timeout);bb.timeout=null}function a6(bb,be){var bc=Math.min(Math.max((be/2)-4,0),2.5);var bd="blur("+bc+"px)";bb.css({"-webkit-filter":bd,filter:bd})}function a5(be,bd){bd.canvas.show();var bb=bd.canvas[0].width/be.canvasRatio;var bc=bd.canvas[0].height/be.canvasRatio}function a9(bg,bc,bd){if(bd.alpha<=0){return}var be=v(bg.metrics,bg.frames,bd.frame,bd.lane);var bi=be.sheet;var bk=be.sprite;if(!bi||!bk){return}var bb=bg.source[bi.id];var bf=bg.images[bi.id];if(bf.complete===false){return}bc.canvas.show();var bj=bc.canvas[0].width/bg.canvasRatio;var bh=bc.canvas[0].height/bg.canvasRatio;bc.context.globalAlpha=bd.alpha;bc.context.drawImage(bf,bk.sampledX,bk.sampledY,bk.sampledWidth,bk.sampledHeight,0,0,bj,bh)}function a2(bf){var be=a0(bf);a1(bf);if(!be.context){return}var bg=0;a5(bf,be);be.context.clearRect(0,0,bf.width,bf.height);for(var bd=0,bb=be.steps;bd<bb.length;bd++){var bc=bb[bd];bc.live=Math.max(bc.live-bc.step,0);bc.alpha=Math.max(bc.live-0.25,0);a9(bf,be,bc);bg+=bc.alpha+bc.d}if(be.cssBlur){a6(be.canvas,bg)}a4(be.steps);if(be.steps.length){a3(bf)}}b(ba,{name:ba,onLoad:a7,onFrameChanged:a8})})();(function(){var a6=Math.max;var a3=Math.min;var a8="ease";function aZ(a9){return A(a9,a8)}function aY(ba,a9,bb){return ba[a9]||bb}function a7(bb,ba){var a9=aZ(ba);a9.maxSamples=a6(aY(ba,"easeMaxSamples",5),0);a9.damping=a6(a3(aY(ba,"easeDamping",0.9),0.999),0);a9.abortTime=a6(aY(ba,"easeAbortTime",250),16);a9.updateTime=a6(aY(ba,"easeUpdateTime",ba.frameTime),16);a9.samples=[];a9.steps=[]}function a2(ba,a9){if(G(a9,"dragging")){a0(a9);aX(a9)}}function a1(bf,be){var a9=aZ(be);var bh=a9.samples;var bj;var ba=0;var bg=0;var bc=0;for(var bd=0,bk=bh;bd<bk.length;bd++){var bi=bk[bd];if(!bj){bj=bi;continue}var bb=bi.time-bj.time;if(bb>a9.abortTime){ba=bg=bc=0;return a0(be)}bg+=bi.frame-bj.frame;ba+=bi.lane-bj.lane;bc+=bb;bj=bi}bh.length=0;if(!bc){return}a9.lane=be.lane;a9.lanes=0;a9.laneStep=ba/bc*a9.updateTime;a9.frame=be.frame;a9.frames=0;a9.frameStep=bg/bc*a9.updateTime;a5(be)}function aX(ba){var a9=aZ(ba);a9.samples.push({time:new Date().getTime(),frame:ba.frame,lane:ba.lane});while(a9.samples.length>a9.maxSamples){a9.samples.shift()}}function a0(ba){var a9=aZ(ba);if(a9.handler!=null){window.clearTimeout(a9.handler);a9.handler=null}}function a5(ba){var a9=aZ(ba);a9.handler=window.setTimeout(function(){a4(ba)},a9.updateTime)}function a4(bb){var ba=aZ(bb);ba.lanes+=ba.laneStep;ba.frames+=ba.frameStep;ba.laneStep*=ba.damping;ba.frameStep*=ba.damping;var bc=Math.floor(ba.frame+ba.frames);var a9=Math.floor(ba.lane+ba.lanes);q(bb,bc,a9);if(G(bb,"dragging")){a0(bb)}else{if(Math.abs(ba.frameStep)>0.005||Math.abs(ba.laneStep)>0.005){a5(bb)}else{a0(bb)}}}b(a8,{name:a8,onLoad:a7,mousemove:a2,mouseup:a1,mouseleave:a1,touchmove:a2,touchend:a1,touchcancel:a1})})();(function(){var a1="gallery";function aZ(a2){return A(a2,a1)}function aY(a3,a2,a4){return a3[a2]||a4}function a0(bb,a9){var a2=aZ(a9);a2.images=[];a2.offsets=[];a2.frame=a9.frame;a2.speed=aY(a9,"gallerySpeed",500);a2.opacity=aY(a9,"galleryOpacity",0.25);a2.stage=aY(a9,"galleryStage",aA("<div></div>"));a2.stage.empty().addClass("gallery-stage").prependTo(a9.stage);var be=0;for(var a7=0,bd=a9.images;a7<bd.length;a7++){var a6=bd[a7];var a4=av(a6);var a5=a9.height/a4.height;var a8=aA(a6);a2.stage.append(a8);a2.images.push(a8);a2.offsets.push(-be+(a9.width-a6.width*a5)/2);be+=a9.width;a8.css({"max-width":"initial",opacity:a2.opacity,width:a9.width,height:a9.height})}var bc=ak(a9);var a3=a9.responsive?l(a9):am(a9);var ba=B(a9.sizeMode,bc,a3);a2.stage.css(ba).css({width:be,left:a2.offsets[a2.frame]});a2.images[a2.frame].animate({opacity:1},{duration:a2.speed})}function aX(a6,a5){var a4=aZ(a5);var a2=u(a5);var a3=G(a5,"dragging");if(a4.frame!==a5.frame&&!a3){a4.stage.stop(true,false).animate({left:a4.offsets[a5.frame]},{duration:a4.speed});a4.images[a4.frame].animate({opacity:a4.opacity},{duration:a4.speed});a4.frame=a5.frame;a4.images[a4.frame].animate({opacity:1},{duration:a4.speed});a4.stage.animate({left:a4.offsets[a4.frame]})}else{if(a3||a4.dX!==a2.dX){a4.dX=a2.dX;a4.ddX=a2.ddX;a4.stage.stop(true,true).css({left:a4.offsets[a4.frame]+a4.dX})}}}b(a1,{name:a1,onLoad:a0,onDraw:aX})})();(function(){var aZ="panorama";function aX(a1){return A(a1,aZ)}function aY(a6,a5){var a4=aX(a5);var a2=a5.metrics[0];if(!a2){return}if(a5.orientation==="horizontal"){a4.scale=a5.target.innerHeight()/a2.sampledHeight;a5.frames=a2.sampledWidth}else{a4.scale=a5.target.innerWidth()/a2.sampledWidth;a5.frames=a2.sampledHeight}var a3=Math.floor(a2.sampledWidth*a4.scale);var a1=Math.floor(a2.sampledHeight*a4.scale);a5.stage.css({"background-image":"url("+a5.source[a2.id]+")","background-repeat":"repeat-both","-webkit-background-size":a3+"px "+a1+"px","-moz-background-size":a3+"px "+a1+"px","-o-background-size":a3+"px "+a1+"px","background-size":a3+"px "+a1+"px"})}function a0(a7,a4){var a3=aX(a4);var a2=a4.orientation==="horizontal"?1:0;var a1=a2?0:1;var a8=a4.frame%a4.frames;var a6=Math.round(a2*a8*a3.scale);var a5=Math.round(a1*a8*a3.scale);a4.stage.css({"background-position":a6+"px "+a5+"px"})}b(aZ,{name:aZ,onLoad:aY,onDraw:a0})})();(function(){var a9="zoom";function a0(ba){return A(ba,a9)}function aX(bb,ba,bc){return ba in bb?bb[ba]:bc}function a7(bc,bb){var ba=a0(bb);ba.source=aX(bb,"zoomSource",bb.source);ba.useWheel=aX(bb,"zoomUseWheel",false);ba.useClick=aX(bb,"zoomUseClick",true);ba.pinFrame=aX(bb,"zoomPinFrame",true);ba.doubleClickTime=aX(bb,"zoomDoubleClickTime",500);ba.stage=ba.stage||aA("<div class='zoom-stage'></div>");ba.stage.css({width:"100%",height:"100%",top:0,left:0,bottom:0,right:0,position:"absolute"}).appendTo(bb.target).hide()}function a8(bc,bb){var ba=a0(bb);if(ba.stage){ba.stage.remove();delete ba.stage}}function aZ(bf,be){var bd=a0(be);if(!bd.stage.is(":visible")){return}bf.preventDefault();if(bd.pinFrame){aV(be,"dragging",false)}var bg=V(bf);var ba=bg.x/be.width;var bh=bg.y/be.height;if(bd.oldX==null){bd.oldX=ba;bd.oldY=bh}if(bd.currentX==null){bd.currentX=ba;bd.currentY=bh}var bc=ba-bd.oldX;var bb=bh-bd.oldY;bd.oldX=ba;bd.oldY=bh;if(bf.type.match(/touch/)){bc=-bc;bb=-bb}bd.currentX=aI(bd.currentX+bc,0,1);bd.currentY=aI(bd.currentY+bb,0,1);q(be,be.frame,be.lane)}function a6(be,bc){var bb=a0(bc);if(!bb.useClick){return}be.preventDefault();var ba=new Date().getTime();if(!bb.clickTime){bb.clickTime=ba;return}var bd=ba-bb.clickTime;if(bd>bb.doubleClickTime){bb.clickTime=ba;return}bb.clickTime=undefined;if(a5(bc)){aZ(be,bc)}}function aY(bc,bb){var ba=a0(bb);if(ba.stage.is(":visible")){aZ(bc,bb)}}function a2(bi,bg){var bc=a0(bg);var bh=bg.lane*bg.frames+bg.frame;var bb=bc.source[bh];var bo=v(bg.metrics,bg.frames,bg.frame,bg.lane);var bl=bc.currentX;var bk=bc.currentY;if(bl==null){bl=bc.currentX=0.5;bk=bc.currentY=0.5}if(bb){bl=Math.floor(bl*100);bk=Math.floor(bk*100);bc.stage.css({"background-repeat":"no-repeat","background-image":"url('"+bb+"')","background-position":bl+"% "+bk+"%"})}else{if(bo.sheet&&bo.sprite){var bm=bo.sprite;var bj=bo.sheet;var ba=bg.source[bj.id];var bf=-Math.floor(bm.sampledX+bl*(bm.sampledWidth-bg.width));var be=-Math.floor(bm.sampledY+bk*(bm.sampledHeight-bg.height));var bd=bj.sampledWidth;var bn=bj.sampledHeight;bc.stage.css({"background-image":"url('"+ba+"')","background-position":bf+"px "+be+"px","background-repeat":"no-repeat","-webkit-background-size":bd+"px "+bn+"px","-moz-background-size":bd+"px "+bn+"px","-o-background-size":bd+"px "+bn+"px","background-size":bd+"px "+bn+"px"})}}}function a5(bb){var ba=a0(bb);if(!ba.stage){throw new Error("zoom module is not initialized or is not available.")}if(ba.stage.is(":visible")){a4(bb)}else{a1(bb);return true}return false}function a4(bb){var ba=a0(bb);ba.stage.fadeOut();bb.stage.fadeIn()}function a1(bb){var ba=a0(bb);ba.stage.fadeIn();bb.stage.fadeOut()}function a3(be,bd){var bc=a0(bd);if(!bd.loading&&bc.useWheel){var ba=be.originalEvent;var bb=ba.deltaY===0?0:ba.deltaY>0?1:-1;if(typeof bc.useWheel==="number"){bb*=bc.useWheel}if(bc.stage.is(":visible")&&bb>0){be.preventDefault();a4(bd)}if(!bc.stage.is(":visible")&&bb<0){be.preventDefault();a1(bd)}}}b(a9,{name:a9,mousedown:a6,touchstart:a6,mousemove:aY,touchmove:aY,wheel:a3,onInit:a7,onDestroy:a8,onDraw:a2});Z({toggleZoom:function(){a5(this.data)}})})();var ah=M;R.Utils=ah;R.sourceArray=i;R.Api=y;R.extendApi=Z;R.instances=ab;R.applyEvents=s;R.boot=Q;R.create=t;R.createOrUpdate=ar;R.destroy=h;R.namespace=ax;R.eventNames=aw;R.callbackNames=ae;R.eventsToPrevent=T;R.defaults=W;R.getInputState=u;R.updateInput=an;R.resetInput=F;R.applyLayout=P;R.getPlaybackState=C;R.updateFrame=q;R.stopAnimation=D;R.applyAnimation=X;R.startAnimation=k;R.registerPlugin=b;R.registerModule=ao;R.getPlugin=c;R.applyPlugins=x;R.getState=r;R.getPluginState=A;R.is=G;R.flag=aV;Object.defineProperty(R,"__esModule",{value:true})})));